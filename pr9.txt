import java.util.*;

public class PageReplacement{
	public static void main(String[] args){
		Scanner sc = new Scanner(System.in);

		System.out.println("Enter number of frames");
		int framesCount = sc.nextInt();

		System.out.println("Enter number of pages in reference string: ");
		int n = sc.nextInt();

		int[] reference = new int[n];
		System.out.print("Entter reference string: ");
		for(int i = 0; i < n; i++){
			reference[i] = sc.nextInt();
		}

		System.out.println("\n=== FIFO Page Replacement ===");
		fifo(reference, framesCount);

		System.out.println("\n=== LRU Page Replacement ===");
		lru(reference, framesCount);

		sc.close();
	}

	public static void fifo(int[] reference, int framesCount){
		Queue<Integer> queue = new LinkedList<>();
		Set<Integer> frames = new HashSet<>();
		int pageFaults = 0;

		System.out.printf("%-10s%-20s%s\n", "Reference", "Frames", "Status");

		for(int page : reference){
			if(!frames.contains(page)){
				if(frames.size() == framesCount){
					int removed = queue.poll();
					frames.remove(removed);
				}
				frames.add(page);
				queue.add(page);
				pageFaults++;
				printFrames(page, frames, "F");
			}
			else{
				printFrames(page, frames, "H");
			}
		}
		System.out.println("Total Page faults = " + pageFaults);
	}

	public static void lru(int[] reference, int framesCount){
		List<Integer> frames = new ArrayList<>();
		int pageFaults = 0;

		System.out.printf("%-10s%-20s%s\n", "Reference", "Frames", "Status");

		for(int page : reference){
			if(frames.contains(page)){
				frames.remove(Integer.valueOf(page));
				frames.add(page);
				printFrames(page, frames, "H");
			} else {
				if(frames.size() == framesCount){
					frames.remove(0);
				}
				frames.add(page);
				pageFaults++;
				printFrames(page, frames, "F");
			}
		}
		System.out.println("Total Page Faults = " + pageFaults);
	}

	public static void printFrames(int page, Collection<Integer> frames, String status){
		System.out.printf("%-10d%-20s%s\n", page, frames, status);
	}
}
